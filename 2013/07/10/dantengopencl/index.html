
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      
        OpenCL学习 - 
      
      CJLD
    </title>
    <meta name="description" content="">
    <meta name="author" content="cjld">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->


    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">    
    <link rel="stylesheet" type="text/css" href="/assets/themes/hooligan/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/hooligan/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">    
    <link href="/assets/themes/hooligan/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/mystyle.css" rel="stylesheet" type="text/css" media="all">    
    <link href="/assets/themes/hooligan/google-code-prettify/doxy.css" rel="stylesheet" type="text/css" media="all">

    
    <!-- fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>      


          <a class="brand" href="/">CJLD</a>


          <div class="nav-collapse">
            <ul class="nav">
              
              
              


  
    
      
      	
      	<li><a href="/about.html">关于</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">文章</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/rss.xml">订阅</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/sand.html">零散</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">标签</a></li>
      	
      
    
  
    
      
    
  



            </ul>
            <ul class="nav pull-right social visible-desktop">
              <li class="divider-vertical"></li>
              
                <li>
                  <a href="https://github.com/cjld" class="zocial github icon" target="_blank">
                    <span class="hidden-desktop">Github</span>
                  </a>
                </li>
              
                  
                                        
                         
                                  
              
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="content">
        
<div class="page-header">
  <h1 id="mainTitle">
    OpenCL学习 
    
  </h1>
</div>

<div class="row">
  <div class="span8">
    <div id="content">
      <p><code>OpenCL</code> <a href="http://zh.wikipedia.org/wiki/OpenCL">wiki</a>,&#31616;&#21333;&#26469;&#35828;&#26159;&#19968;&#20010;&#29992;&#20110;&#24182;&#34892;&#35745;&#31639;&#35774;&#22791;&#30340;&#26631;&#20934;api&#65292;&#19968;&#24320;&#22987;&#35273;&#24471;CUDA&#21644;OpenCL&#26159;&#31454;&#20105;&#20851;&#31995;&#65292;&#21518;&#38754;&#31245;&#24494;&#20102;&#35299;&#20102;&#20197;&#21518;&#25165;&#21457;&#29616;&#20182;&#20204;&#20043;&#38388;&#26159;&#21253;&#23481;&#20851;&#31995;&#12290;</p>
<p>&#20960;&#20046;&#25152;&#26377;&#24179;&#21488;&#37117;&#26377;&#23454;&#29616;openCL&#65292;intel,AMD,Nvidia,CUDA&#26159;Nvidia&#22312;openCL&#19978;&#21448;&#36827;&#34892;&#20102;&#23553;&#35013;&#21644;&#19968;&#20123;&#38024;&#23545;N&#21345;&#20248;&#21270;&#30340;SDK&#65292;&#30456;&#27604;&#20043;openCL&#26356;&#23481;&#26131;&#19978;&#25163;&#65292;&#19981;&#24471;&#19981;&#21520;&#27133;openCL&#20196;&#20154;&#34507;&#30862;&#30340;&#32431;C&#29992;&#27861;&#12290;</p>
<p>&#26412;&#25991;&#21442;&#32771;&#33258; <a href="http://blog.csdn.net/leonwei/article/category/1410041">http://blog.csdn.net/leonwei/article/category/1410041</a> &#65292;&#20316;&#32773;&#20889;&#30340;&#24456;&#19981;&#38169;&#65292;&#35753;&#25105;&#33021;&#24555;&#36895;&#20837;&#38376;&#12290;</p>
<p>&#20080;&#22238;&#26469;&#19968;&#26412;&#20070;&#32467;&#26524;&#21457;&#29616;&#35762;&#30340;&#26159;openCL1.1&#30340;&#65292;2011&#24180;&#24180;&#24213;&#23601;&#24050;&#32463;&#20986;1.2&#26631;&#20934;&#20102;&#8230;&#22269;&#20869;&#36164;&#26009;&#30340;&#26102;&#25928;&#24615;&#36824;&#26159;&#19981;&#22815;&#21834;&#65292;&#22312;&#32593;&#19978;&#25214;&#21040;&#20102;&#20123;&#27604;&#36739;&#26435;&#23041;&#30340;&#23398;&#20064;&#36164;&#26009;&#65306;</p>
<ul>
<li>&#23448;&#26041;reference<a href="http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/">http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/</a></li>
<li>openCL1.2 overview<a href="http://www.khronos.org/assets/uploads/developers/library/overview/opencl-overview.pdf">http://www.khronos.org/assets/uploads/developers/library/overview/opencl-overview.pdf</a></li>
<li>&#23448;&#26041;&#20837;&#38376;&#25945;&#26448; <a href="http://developer.amd.com/wordpress/media/2012/10/opencl-1.2.pdf">http://developer.amd.com/wordpress/media/2012/10/opencl-1.2.pdf</a></li>
</ul>
<h2 id="opencl&#26550;&#26500;">OpenCL&#26550;&#26500;</h2>
<p>&#31508;&#32773;&#31616;&#21333;&#24635;&#32467;&#20102;&#19979;OpenCL&#30340;&#26550;&#26500;&#21644;&#19968;&#20010;&#31616;&#21333;&#30340;&#21152;&#27861;&#22120;&#23454;&#29616;&#65292;&#26377;&#38169;&#35823;&#36824;&#26395;&#25351;&#20986;:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Paltform</strong> &#24179;&#21488;&#65292;&#30456;&#24403;&#20110;&#19981;&#21516;&#21378;&#21830;&#30340;OpenCL&#23454;&#29616;&#65292;&#27604;&#22914;intel&#23454;&#29616;&#20102;&#65292;AMD&#23454;&#29616;&#20102;&#24182;&#19988;&#25105;&#21448;&#21516;&#26102;&#35013;&#20102;&#20004;&#32773;&#30340;openCL sdk&#65292;&#37027;&#25105;&#23601;&#20250;&#26377;&#20004;&#32773;&#30340;&#24179;&#21488;&#12290;</p>
<p>&#33719;&#24471;&#25152;&#26377;Platform&#20989;&#25968;&#65306;</p>
<pre><code>cl_int clGetPlatformIDs(
    cl_uint num_entries,
    cl_platform_id *platforms,
    cl_uint *num_platforms)</code></pre>
<p>&#22312;OpenCL&#37324;&#38754;&#20026;&#20102;&#33719;&#21462;&#19968;&#20010;&#25968;&#32452;&#20803;&#32032;&#65292;&#37117;&#21644;&#36825;&#20010;&#32467;&#26500;&#24046;&#19981;&#22810;</p>
<ul>
<li><code>num_entries</code> &#25351;&#21517;<code>platforms</code>&#25351;&#38024;&#25351;&#21521;&#30340;&#31354;&#38388;&#26377;&#22810;&#22823;&#65292;&#38450;&#27490;&#36234;&#30028;</li>
<li><code>platforms</code> &#29992;&#26469;&#23384;&#25918;&#21015;&#34920;&#30340;&#25351;&#38024;,&#38656;&#35201;&#20320;&#22312;&#22806;&#37096;&#30003;&#35831;&#22909;&#31354;&#38388;</li>
<li><code>num_platforms</code> &#36820;&#22238;&#26377;&#22810;&#23569;&#20010;platforms</li>
<li>&#38169;&#35823;&#30721; OpenCL&#37324;&#30340;&#25152;&#26377;&#20989;&#25968;&#20960;&#20046;&#37117;&#26377;&#38169;&#35823;&#36820;&#22238;&#20540;&#65292;&#20855;&#20307;&#38169;&#35823;&#36820;&#22238;&#20540;&#20195;&#34920;&#30340;&#24847;&#24605;&#21487;&#20197;&#21040;<code>CL/cl.h</code>&#22836;&#25991;&#20214;&#26597;&#30475;&#12290;&#38169;&#35823;&#36820;&#22238;&#20540;&#19968;&#33324;&#26159;&#20989;&#25968;&#30340;&#36820;&#22238;&#20540;&#25110;&#32773;&#26159;&#26368;&#21518;&#19968;&#20010;&#21442;&#25968;&#12290;</li>
</ul>
<p>&#20551;&#35774;<code>num_entries&lt;num_platforms</code>&#65292;&#37027;&#20040;&#20182;&#21482;&#20250;&#21543;&#21069;<code>num_entries</code>&#20010;platform&#23384;&#36215;&#26469;&#65292;&#20030;&#20363;&#65306;</p>
<pre><code>//get platform numbers
err = clGetPlatformIDs(0, 0, &amp;num);

//get all platforms
vector&lt;cl_platform_id&gt; platforms(num);
err = clGetPlatformIDs(num, &amp;platforms[0], &amp;num);</code></pre></li>
<li><p><strong>Device</strong> &#35774;&#22791;&#65292;&#20063;&#23601;&#26159;&#29992;&#26469;&#36816;&#31639;&#30340;&#23454;&#20307;</p>
<p>&#33719;&#21462;&#25152;&#26377;&#35774;&#22791;&#30340;&#20989;&#25968;&#65306;</p>
<pre><code>cl_int clGetDeviceIDs (
    cl_platform_id  platform ,
    cl_device_type  device_type ,
    cl_uint  num_entries ,
    cl_device_id  *devices ,
    cl_uint  *num_devices )</code></pre>
<ul>
<li><code>platform</code> &#36873;&#25321;&#19968;&#20010;&#24179;&#21488;</li>
<li><code>device_type</code> &#20320;&#38656;&#35201;&#30340;&#35774;&#22791;&#31867;&#22411;&#65292;&#26377;&#22914;&#19979;&#20960;&#31181;</li>
<li><code>CL_DEVICE_TYPE_CPU</code></li>
<li><code>CL_DEVICE_TYPE_GPU</code></li>
<li><code>CL_DEVICE_TYPE_ACCELERATOR</code></li>
<li><code>CL_DEVICE_TYPE_CUSTOM</code></li>
<li><code>CL_DEVICE_TYPE_DEFAULT</code></li>
<li><code>CL_DEVICE_TYPE_ALL</code></li>
<li>&#21518;&#38754;&#36825;&#20123;&#21442;&#25968;&#29992;&#26469;&#33719;&#21462;&#21015;&#34920;</li>
</ul>
<p>&#33719;&#21462;&#35774;&#22791;&#20449;&#24687;&#65306;<code>clGetDeviceInfo</code> &#65292;&#20855;&#20307;&#29992;&#27861;&#25139;<a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clGetDeviceInfo.html">&#36825;&#37324;</a></p>
<p>&#20030;&#20363;&#65306;</p>
<pre><code>//get device num
err=clGetDeviceIDs(platforms[DID],CL_DEVICE_TYPE_ALL,0,0,&amp;num);
vector&lt;cl_device_id&gt; did(num);
//get all device
err=clGetDeviceIDs(platforms[DID],CL_DEVICE_TYPE_ALL,num,&amp;did[0],&amp;num);
cout&lt;&lt;&quot;number of device: &quot;&lt;&lt;num&lt;&lt;endl;
clGetDeviceInfo(did[0],
    CL_DEVICE_TYPE,
    infoSize,
    info,
    &amp;infoSize);
cout&lt;&lt;*((cl_device_type*)info)&lt;&lt;endl;</code></pre></li>
<li><p><strong>context</strong> &#19978;&#19979;&#25991;&#65292;&#29992;&#26469;&#27807;&#36890;&#35774;&#22791;&#24179;&#21488;&#21644;&#35745;&#31639;&#20219;&#21153;&#12290;</p>
<p>&#21019;&#24314;&#19978;&#19979;&#25991;&#65306;</p>
<pre><code>cl_context clCreateContextFromType (
    cl_context_properties   *properties,
    cl_device_type  device_type,
    void  (*pfn_notify) (
      const char *errinfo,
      const void  *private_info,
      size_t  cb,
      void  *user_data),
    void  *user_data,
    cl_int  *errcode_ret)</code></pre>
<ul>
<li><code>properties</code> &#19978;&#19979;&#25991;&#30340;&#23646;&#24615;&#65292;&#29992;&#26469;&#25351;&#23450;&#24179;&#21488; &gt;openCL&#20013;&#30340;&#35774;&#32622;&#24207;&#21015;&#19968;&#33324;&#37117;&#26159;&#12300;property &#31181;&#31867;&#12301;&#21450;&#12300;property &#20839;&#23481;&#12301;&#25104;&#23545;&#20986;&#29616;&#65292;&#24182;&#20197; 0 &#20570;&#20026;&#32467;&#26463;&#12290;</li>
<li><code>device_type</code> &#36873;&#25321;&#29992;&#24179;&#21488;&#20013;&#30340;&#37027;&#20123;&#35774;&#22791;&#26469;&#21019;&#24314;&#19978;&#19979;&#25991;</li>
<li><code>pfn_notify</code> &#38169;&#35823;&#22238;&#35843;&#20989;&#25968;</li>
<li><code>user_data</code> &#29992;&#26469;&#20256;&#32473;&#22238;&#35843;&#20989;&#25968;&#30340;&#21442;&#25968;</li>
<li>&#38169;&#35823;&#30721;</li>
</ul>
<p>&#20030;&#20363;&#65306;</p>
<pre><code>//set property with certain platform
cl_context_properties prop[] = { CL_CONTEXT_PLATFORM, reinterpret_cast&lt;cl_context_properties&gt;(platforms[DID]), 0 };
cl_context context = clCreateContextFromType(prop, CL_DEVICE_TYPE_ALL, NULL, NULL, &amp;err);</code></pre></li>
<li><p><strong>commandQueue</strong> &#29992;&#26469;&#32473;device&#21457;&#36865;&#25351;&#20196;</p>
<pre><code>cl_command_queue clCreateCommandQueue(
    cl_context context,
    cl_device_id device,
    cl_command_queue_properties properties,
    cl_int *errcode_ret)</code></pre>
<ul>
<li><code>context</code> &#25351;&#23450;&#19978;&#19979;&#25991;</li>
<li><code>device</code> &#25351;&#23450;&#35774;&#22791;</li>
<li><code>properties</code> commandQueue&#35774;&#32622;&#65292;<a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clCreateCommandQueue.html">&#35814;&#35265;</a></li>
<li>&#38169;&#35823;&#30721;</li>
</ul>
<p>&#20030;&#20363;&#65306;</p>
<pre><code>cl_command_queue cqueue = clCreateCommandQueue(context, did[0], 0, &amp;err);</code></pre></li>
<li><p><strong>program</strong> &#22312;&#19978;&#19979;&#25991;&#20013;&#21152;&#36733;&#20195;&#30721;&#65292;&#20998;&#20004;&#20010;&#27493;&#39588;&#65306;</p>
<ul>
<li>&#21152;&#36733;</li>
</ul>
<p><a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clCreateProgramWithSource.html">clCreateProgramWithSource</a></p>
<ul>
<li>&#32534;&#35793;</li>
</ul>
<p><a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clBuildProgram.html">clBuildProgram</a></p>
<p>&#21442;&#25968;&#35774;&#32622;&#20160;&#20040;&#30340;&#22826;&#22810;&#20102;&#65292;&#19981;&#19968;&#19968;&#35814;&#35299;&#20102;&#65292;&#20030;&#20363;:</p>
<pre><code>const char *src=getAllFile(&quot;kernal1.cl&quot;);
cl_program program = clCreateProgramWithSource(context, 1, &amp;src, 0, 0);
err = clBuildProgram(program, 0, 0, 0, 0, 0);</code></pre>
<p>&#36825;&#37324;&#30340;<code>kernal1.cl</code>&#20351;&#29992;&#29305;&#27530;&#30340;&#35821;&#35328;&#20889;&#30340;&#65292;&#24863;&#35273;&#20960;&#20046;&#23601;&#26159;c&#35821;&#35328;&#65292;<del>&#21482;&#19981;&#36807;&#19981;&#33021;&#35843;&#29992;&#20989;&#25968;</del>&#19981;&#36807;&#36824;&#26159;&#26377;&#19968;&#20123;&#38480;&#21046;&#30340;&#12290;</p>
<pre><code>//kernal1.cl
__kernel void adder(__global const float* a, __global const float* b, __global float* result)
{
  int idx = get_global_id(0);
  result[idx] = a[idx] +b[idx];
}</code></pre></li>
<li><p><strong>kernel</strong> &#30456;&#24403;&#20110;&#19968;&#27425;&#20989;&#25968;&#35843;&#29992;&#65292;&#20174;<code>program</code>&#37324;&#25214;&#19968;&#20010;&#20989;&#25968;&#35843;&#29992;&#12290;</p>
<pre><code>cl_kernel adder = clCreateKernel(program, &quot;adder&quot;, &amp;err);</code></pre></li>
<li><p><strong>Buffer</strong> &#30456;&#24403;&#20110;&#20379;&#20989;&#25968;&#35843;&#29992;&#30340;&#21442;&#25968;&#12290;</p>
<p>&#21019;&#24314;buffer&#65306;</p>
<pre><code>cl_mem clCreateBuffer (
    cl_context context,
    cl_mem_flags flags,
    size_t size,
    void *host_ptr,
    cl_int *errcode_ret)</code></pre>
<ul>
<li><code>context</code> &#36873;&#25321;&#19978;&#19979;&#25991;</li>
<li><code>flags</code> &#29992;&#26469;&#20915;&#23450;&#36825;&#20010;buffer&#30340;&#23646;&#24615;&#65292;&#27604;&#22914;&#21482;&#35835;&#65292;&#21482;&#20889;&#65292;&#26159;&#21542;&#38656;&#35201;&#21021;&#22987;&#21270;&#31561;&#31561;&#65292;<a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clCreateBuffer.html">&#35814;&#35265;</a></li>
<li><code>size</code> <code>host_ptr</code> &#29992;&#20110;&#25552;&#20379;&#21021;&#22987;&#21270;&#30340;&#25968;&#32452;</li>
<li>&#38169;&#35823;&#30721;</li>
</ul>
<p>&#35774;&#32622;&#21442;&#25968;&#65306;</p>
<pre><code>cl_int clSetKernelArg (
    cl_kernel kernel,
    cl_uint arg_index,
    size_t arg_size,
    const void *arg_value)</code></pre>
<p>&#20030;&#20363;&#65306;</p>
<pre><code>cl_mem cl_a = clCreateBuffer(context, CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR, sizeof(cl_float) * DATA_SIZE, &amp;a[0], NULL);
cl_mem cl_b = clCreateBuffer(context, CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR, sizeof(cl_float) * DATA_SIZE, &amp;b[0], NULL);
cl_mem cl_res = clCreateBuffer(context, CL_MEM_WRITE_ONLY, sizeof(cl_float) * DATA_SIZE, NULL, NULL);
clSetKernelArg(adder, 0, sizeof(cl_mem), &amp;cl_a);
clSetKernelArg(adder, 1, sizeof(cl_mem), &amp;cl_b);
clSetKernelArg(adder, 2, sizeof(cl_mem), &amp;cl_res);</code></pre></li>
</ol>
<h2 id="&#36816;&#34892;&#31243;&#24207;">&#36816;&#34892;&#31243;&#24207;</h2>
<p>&#36816;&#34892;&#31243;&#24207;&#20998;&#20004;&#27493;&#65292;&#21019;&#24314;&#36816;&#34892;&#25351;&#20196;&#21644;&#25335;&#36125;&#36816;&#34892;&#32467;&#26524;&#65292;&#35980;&#20284;&#31243;&#24207;&#30495;&#27491;&#30340;&#25191;&#34892;&#26159;&#22312;&#25335;&#36125;&#36816;&#34892;&#32467;&#26524;&#30340;&#26102;&#20505;&#65311;</p>
<p>&#21019;&#24314;&#36816;&#34892;&#25351;&#20196;:</p>
<pre><code>clEnqueueNDRangeKernel(
    cl_command_queue queue&#65292;
    cl_kernel kernel&#65292;
    cl_uint work_dims&#65292;
    const size_t *global_work_offset,
    const size_t *global_work_size, 
    const size_t *local_work_size,
    cl_uint num_events,
    const cl_event *wait_list,
    cl_event *event)</code></pre>
<ul>
<li><code>queue</code> <code>kernel</code> &#25351;&#23450;&#38431;&#21015;&#21644;&#20869;&#26680;</li>
<li><code>work_dims</code> &#35774;&#23450;&#21442;&#25968;&#30340;&#32500;&#24230;&#65292;&#27880;&#24847;&#65292;&#36825;&#20010;&#21442;&#25968;&#26159;&#29992;&#26469;&#20256;&#36882;&#32473;&#19981;&#21516;&#36827;&#31243;&#30340;&#21442;&#25968;&#65292;&#21516;&#26679;&#20063;&#26159;&#25509;&#19979;&#26469;&#19977;&#20010;&#25968;&#32452;&#30340;&#22823;&#23567;&#65292;kernel&#37324;&#21487;&#20197;&#36890;&#36807;<code>get_work_dim</code>&#26469;&#33719;&#24471;&#12290;</li>
<li><code>global_work_offset</code> &#27599;&#19968;&#32500;&#21021;&#22987;&#19979;&#26631;</li>
<li><code>global_work_size</code> &#27599;&#19968;&#32500;&#32467;&#26463;&#19979;&#26631;+1</li>
<li><code>local_work_size</code> &#26242;&#26102;&#19981;&#22826;&#28165;&#26970;&#20160;&#20040;&#29992;&#65292;&#22909;&#20687;&#30446;&#30340;&#26159;&#21543;&#19981;&#21516;&#36827;&#31243;&#25414;&#32465;&#36215;&#26469;&#20415;&#20110;&#27807;&#36890;&#65311;</li>
<li><code>num_events</code> <code>wait_list</code> &#29992;&#26469;&#35774;&#23450;&#22312;&#36825;&#20010;&#21629;&#20196;&#20043;&#21069;&#38656;&#35201;&#23436;&#25104;&#37027;&#20123;&#21629;&#20196;</li>
<li><code>event</code> &#36820;&#22238;&#24403;&#21069;&#20107;&#20214;</li>
</ul>
<p>&#25335;&#36125;&#36816;&#34892;&#32467;&#26524;&#65306;</p>
<pre><code>cl_int clEnqueueReadBuffer (
    cl_command_queue command_queue,
    cl_mem buffer,
    cl_bool blocking_read,
    size_t offset,
    size_t cb,
    void *ptr,
    cl_uint num_events_in_wait_list,
    const cl_event *event_wait_list,
    cl_event *event)</code></pre>
<p>&#35980;&#20284;&#26377;&#20123;&#21644;&#21516;&#27493;&#24322;&#27493;&#26377;&#20851;&#30340;&#19996;&#35199;&#65292;&#36824;&#19981;&#22826;&#26126;&#30333;&#65292;&#20855;&#20307;<a href="http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clEnqueueReadBuffer.html">&#25139;&#36825;&#37324;</a>&#12290;</p>
<p>&#20030;&#20363;&#65306;</p>
<pre><code>size_t work_size=DATA_SIZE-1;
cout&lt;&lt;&quot;begin run....&quot;&lt;&lt;endl;
long long tt=clock();
err = clEnqueueNDRangeKernel(cqueue, adder, 1, 0, &amp;work_size, 0, 0, 0, 0);
cout&lt;&lt;&quot;err:&quot;&lt;&lt;err&lt;&lt;&#39; &#39;&lt;&lt;work_size&lt;&lt;&#39; &#39;&lt;&lt;clock()-tt&lt;&lt;endl;

tt=clock();
vector&lt;float&gt; res(DATA_SIZE);
err = clEnqueueReadBuffer(cqueue, cl_res, CL_TRUE, 0, sizeof(float) * DATA_SIZE, &amp;res[0], 0, 0, 0);</code></pre>
<p>&#36825;&#26679;&#19968;&#20010;&#31616;&#26131;&#30340;&#24182;&#34892;&#21152;&#27861;&#22120;&#23601;&#23436;&#25104;&#20102;&#65292; <a href="https://github.com/cjld/opencl1">&#23436;&#25972;&#20195;&#30721;</a></p>
<p>&#31616;&#21333;&#30340;&#21033;&#29992;&#36825;&#20010;&#21152;&#27861;&#22120;&#23545;&#25105;&#30340;CPU(i5-2410M)&#20197;&#21450;GPU(AMD HD 6470M)&#30340;&#24615;&#33021;&#20570;&#20102;&#19968;&#19979;&#27979;&#35797;&#65306;</p>
<p>&#19968;&#20849;500&#20010;&#36827;&#31243;&#65292;&#27599;&#20010;&#36827;&#31243;&#20570;10000000&#27425;&#28014;&#28857;&#21152;&#27861;&#65292;&#32467;&#26524;&#20998;&#21035;&#22914;&#19979;&#65306;</p>
<ul>
<li>AMD&#24179;&#21488;&#30340;GPU(AMD HD 6470M) device <strong>260ms</strong> &#30456;&#24403;&#20110;192GHz</li>
<li>AMD&#24179;&#21488;&#30340;CPU(i5-2410M) device <strong>530ms</strong> &#30456;&#24403;&#20110;94GHz</li>
<li>intel&#24179;&#21488;&#30340;CPU(i5-2410M) device <strong>136ms</strong> &#30456;&#24403;&#20110;367Ghz</li>
</ul>
<p>&#36825;&#19981;&#31185;&#23398;&#21834;&#8230;&#25105;&#20026;&#20102;&#38450;&#27490;&#20182;&#20599;&#20599;&#24110;&#25105;&#21152;&#20248;&#21270;&#65292;&#36824;&#29305;&#22320;&#25913;&#25104;&#20102;fibonacci&#25968;&#21015;&#27714;&#35299;&#65292;&#38590;&#19981;&#25104;&#20320;&#37117;&#26234;&#33021;&#21040;&#33258;&#21160;&#30697;&#38453;&#20056;&#27861;&#20248;&#21270;&#20102;&#65311;&#36824;&#26377;&#26174;&#21345;&#36305;&#30340;&#36824;&#27809;cpu&#24555;&#20320;&#24178;&#22043;&#21507;&#30340;&#8230;</p>
<p>&#21478;&#22806;&#25105;&#24050;&#32463;&#24443;&#24213;&#25104;&#20026;A&#21345;&#40657;&#20102;&#65292;&#22312;win8&#19979;&#39537;&#21160;&#35013;&#20102;&#19968;&#24180;&#37117;&#27809;&#35013;&#22909;&#65292;&#32780;&#19988;&#22238;win7&#29992;opencl&#36824;&#20250;&#33707;&#21517;&#20854;&#22937;&#30340;&#34013;&#23631;&#12290;</p>

    </div>
    <hr>
    <div class="pagination btn-group">
      
        <a class="btn prev" href="/2013/07/07/cssgood" title="CSS3挺不错的">&larr; Previous</a>
      
        <a class="btn" href="/archive.html">Archive</a>
      
        <a class="btn next" href="/2013/07/11/codehighlight" title="Google-Code-Prettfy添加代码高亮">Next &rarr;</a>
      
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'cjldblog'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <section>
    <h3><i class="icon-calendar"></i>Published</h3>
      <div class="date"><span style="margin-left: 20px">10 July 2013</span></div>
    </section>
         
    
      <section id="tags_box">
        <h3><i class="icon-tags"></i>Tags</h3>
        <ul class="tag_box" style="margin-left: 20px">
          
          


  
     
    	<li><a href="/tags.html#OpenCL-ref">OpenCL <span>10</span></a></li>
    
  



        </ul>
      </section>
       
      <section id="contents">
        <h3><i class="icon-th-list"></i>Contents</h3>
        <div id="content_box">
        </div>
      </section>
  </div>
</div>


      </div>

      <footer>
        <p>&copy; 2013 cjld
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://github.com/dhulihan/hooligan" target="_blank">The Hooligan Theme</a>
        </p>
      </footer>
    </div> <!-- /container -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/hooligan/js/jquery.min.js"><\/script>')</script>
    <script type="text/javascript" src="/assets/themes/hooligan/js/gen_content.js"></script>
    <script src="/assets/themes/hooligan/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/themes/hooligan/google-code-prettify/prettify.js"></script>
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/javascript">
      $(document).ready(function(){
           $("pre").addClass("prettyprint");
           prettyPrint();
      })
    </script>
    

    
  </body>
</html>

